# نظام التنبيهات الذكية (Smart Alerts System)

## نظرة عامة

مكون [AlertsManager](file:///c:/Users/mojah/Downloads/hasebny/hasebny-payroll-system/src/components/dashboard/AlertsManager.tsx#L29-L227) هو نظام تنبيهات ذكية لمراقبة وتحليل بيانات الموظفين وإصدار تنبيهات تلقائية عند اكتشاف مشكلات أو أحداث مهمة.

## الميزات

### 1. مراقبة انتهاء عقود الموظفين
- يراقب الموظفين الذين تنتهي عقودهم خلال 30 يومًا
- يصنف التنبيهات حسب مستوى الخطورة:
  - عالي: انتهاء العقد خلال 7 أيام أو أقل
  - متوسط: انتهاء العقد خلال 15 يومًا أو أقل
  - منخفض: انتهاء العقد خلال 30 يومًا أو أقل

### 2. مراقبة تجاوز حد الغياب المسموح
- يراقب الموظفين الذين تجاوزوا حد الغياب (5 أيام في الشهر)
- يصنف التنبيهات حسب عدد أيام الغياب:
  - عالي: أكثر من 10 أيام غياب
  - متوسط: أكثر من 7 أيام غياب
  - منخفض: أكثر من 5 أيام غياب

### 3. مراقبة اقتراب مواعيد المراجعة السنوية
- يراقب اقتراب الذكرى السنوية لتوظيف الموظفين
- يصنف التنبيهات حسب المدة المتبقية حتى المراجعة:
  - عالي: المراجعة خلال 7 أيام أو أقل
  - متوسط: المراجعة خلال 15 يومًا أو أقل
  - منخفض: المراجعة خلال 30 يومًا أو أقل

### 4. تحذير من أخطاء في حساب الرواتب
- يراقب البيانات المالية للموظفين للبحث عن قيم غير صحيحة
- يصدر تنبيهات في الحالات التالية:
  - راتب أساسي سالب
  - قيمة إحدى البدلات سالبة
  - بيانات موظف غير مكتملة

## التكامل

تم دمج مكون [AlertsManager](file:///c:/Users/mojah/Downloads/hasebny/hasebny-payroll-system/src/components/dashboard/AlertsManager.tsx#L29-L227) في لوحة تحكم المدير في ملف [AdminAnalytics.tsx](file:///c:/Users/mojah/Downloads/hasebny/hasebny-payroll-system/src/components/dashboard/AdminAnalytics.tsx).

## الاستخدام

يتم تمرير خاصيتين إلى المكون:
- `workers`: قائمة ببيانات الموظفين
- `isAdmin`: مؤشر على ما إذا كان المستخدم مسؤولاً (يتم عرض التنبيهات فقط للمسؤولين)

## التخصيص

يمكن تخصيص عتبات التنبيه بتعديل القيم في الكود:
- عتبة الغياب: `worker.absentDays > 5`
- عتبة انتهاء العقد: 30 يومًا
- عتبة المراجعة السنوية: 30 يومًا

## التحسينات الجديدة

### 1. مراقبة أكثر دقة لانتهاء العقود
- التحقق من حقل `terminationDate` بدلاً من الحالة فقط

### 2. تحسين التحقق من أخطاء الرواتب
- التحقق من السالب في جميع البدلات وليس فقط الراتب الأساسي
- التحقق من اكتمال بيانات الموظف

### 3. تحديد أكثر دقة لفترة الغياب
- تتبع الغياب حسب الشهر الحالي

## التصميم

- واجهة مستخدم مرنة مع إمكانية توسيع/طي قائمة التنبيهات
- تصنيف بالألوان حسب مستوى الخطورة
- عرض معلومات تفصيلية لكل تنبيه
- عرض عدد التنبيهات الإجمالي